<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Concept Learning Algorithms Examples in R using the Alzheimer’s Data</title>
    <meta charset="utf-8" />
    <meta name="author" content="Lynn Gao" />
    <script src="libs/header-attrs-2.22/header-attrs.js"></script>
    <link rel="stylesheet" href="slide-style.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">


class: title-slide



&lt;br&gt;
&lt;br&gt;
.right-panel[ 

# Concept Learning Algorithms
Examples in R using the Alzheimer's Data
## Lynn Gao

]


---

## Load in libraries and the data



```r
library(tidyverse)
AD &lt;- read_csv("./data/alzheimer_data.csv") 
```

---

## Load in libraries and the data

We'll also use some practice data:

|Time |	Weather |	Temperature |	Company |	Humidity |	Wind |	Goes on a walk |
|-------|-------|-------|-------|-------|-------|-------------------|
|Morning |	Sunny |	Warm |	Yes |	Mild |	Strong |	Yes |
| Evening |	Rainy |	Cold |	No |	Mild |	Normal |	No |
| Morning |	Sunny |	Moderate |	Yes |	Normal |	Normal |	Yes |
| Evening |	Sunny |	Cold |	Yes |	High |	Strong |	Yes |


```r
Walk &lt;- as.data.frame(rbind(
              c("Morning",	"Sunny",	"Warm",	"Yes",	"Mild",	"Strong",	"Yes"),
              c("Evening",	"Rainy",	"Cold",	"No",	"Mild",	"Normal",	"No"),
              c("Morning",	"Sunny",	"Moderate",	"Yes",	"Normal",	"Normal",	"Yes"),
              c("Evening",	"Sunny",	"Cold",	"Yes",	"High",	"Strong",	"Yes")))
colnames(Walk) = c("Time",	"Weather",	"Temperature",	"Company",	"Humidity",	"Wind",	"Goes")
```

---

Before we start, let's quickly go over for loops in R.


```r
walk_columns = colnames(Walk)
```

.pull-left[

```r
for(i in 1:length(walk_columns)){
  print(i)
}
```

```
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
```
]

.pull-right[

```r
for(i in walk_columns){
  print(i)
}
```

```
## [1] "Time"
## [1] "Weather"
## [1] "Temperature"
## [1] "Company"
## [1] "Humidity"
## [1] "Wind"
## [1] "Goes"
```

]


---

I wasn't able to find any libraries in R that implemented the specific concept learning algorithms we learned today, so let's implement the algorithms ourselves! 


```r
# first, let's subset the data and choose which categorical variables we want to include and which rows we want to include
AD_subset &lt;- AD %&gt;% 
  select(diagnosis, travel, bills, taxes) %&gt;% 
  mutate(has_ad = ifelse(diagnosis == 2, "AD", "No AD"),
         travel = as.factor(travel), 
         bills = as.factor(bills), 
         taxes = as.factor(taxes)) %&gt;% 
  slice(1:20)
```

---
class: middle

.pull-left[

```r
# the attributes
data &lt;- AD_subset[,2:4]
data
```

```
## # A tibble: 20 × 3
##    travel bills taxes
##    &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;
##  1 0      0     0    
##  2 0      0     0    
##  3 0      0     0    
##  4 0      0     0    
##  5 0      0     0    
##  6 0      0     0    
##  7 0      0     0    
##  8 0      0     0    
##  9 0      0     0    
## 10 2      2     2    
## 11 0      0     0    
## 12 0      0     0    
## 13 0      0     0    
## 14 0      0     0    
## 15 0      0     0    
## 16 0      0     1    
## 17 3      8     8    
## 18 0      1     2    
## 19 3      3     3    
## 20 1      2     3
```
]

.pull-right[

```r
# the target
target &lt;- AD_subset %&gt;% 
  pull(has_ad) 
target
```

```
##  [1] "No AD" "No AD" "No AD" "No AD" "No AD" "No AD" "No AD" "AD"    "No AD"
## [10] "AD"    "No AD" "No AD" "No AD" "No AD" "No AD" "No AD" "AD"    "AD"   
## [19] "AD"    "No AD"
```
]

---

## Find-S Algorithm


```r
finds &lt;- function(data, target, positive_factor){
  for (i in 1:length(target)){
    if (target[i] == positive_factor){
      specific_hypothesis = data[i,]
      break
    }
  }
  for (i in 1:length(target)){
    if (target[i] == positive_factor){
      for (j in 1:length(specific_hypothesis)){
        if (data[i,j] != specific_hypothesis[j]){
          specific_hypothesis[j] = '?'
        }
      }
    }
  }
  return(specific_hypothesis)
}
```

---

As our result, we get a final hypothesis that is very general, which makes sense because not all people with Alzheimer's may have trouble travelling, paying bills, or paying taxes.


```r
finds(data, target, "AD")
```

```
## # A tibble: 1 × 3
##   travel bills taxes
##   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
## 1 ?      ?     ?
```

---

Now let's use our practice data to see the implemented algorithm with different results.


```r
walk_target &lt;- Walk$Goes
walk_data &lt;- Walk[,1:6]
finds(walk_data, walk_target, "Yes")
```

```
##   Time Weather Temperature Company Humidity Wind
## 1    ?   Sunny           ?     Yes        ?    ?
```

Looking at our final hypothesis, we can see that if it is Sunny and the person has Company, then they will go on a walk.
---

### Practice

- Select a categorical variable for the target (ex: sex, has_ad) and *at least three* other categorical variables for the attributes.
- Perform the Find-S Algorithm on your data. 
- Are there any trends in your final hypotheses? Were there any attributes that were consistent among positive examples?

Extra:
- Implement the Find-S Algorithm with the EnjoySport data from lecture this morning.

---

## Candidate-Elimination Algorithm



```r
cea &lt;- function(data, target, positive_factor){
  specific_h &lt;- as.matrix(data[1,])
  general_h &lt;- matrix(rep("?", length(specific_h)*length(specific_h)), 
                      nrow = length(specific_h),
                      ncol = length(specific_h))
  for (i in 1:length(target)){
    if (target[i] == positive_factor){
      for (j in 1:length(specific_h)){
        if (data[i,j] != specific_h[j]){
          specific_h[j] = "?"
          general_h[j,j] = "?"
        }
      }
    }
    if (target[i] != positive_factor){
      for (j in 1:length(specific_h)){
        if (data[i,j] != specific_h[j]){
          general_h[j,j] = specific_h[j]
        }
        else {
          general_h[j,j] = "?"
        }
      }
    }
  }
  print(specific_h)
  return(general_h)
}
```

---

Again, we see that the resulting hypotheses for our Alzheimer's data are very general. 


```r
cea(data, target, "AD")
```

```
##      travel bills taxes
## [1,] "?"    "?"   "?"
```

```
##      [,1] [,2] [,3]
## [1,] "?"  "?"  "?" 
## [2,] "?"  "?"  "?" 
## [3,] "?"  "?"  "?"
```

---

The results of the Candidate-Elimination Algorithm for the walking data gives us the same results as for the Find-S Algorithm.


```r
cea(walk_data, walk_target, "Yes")
```

```
##   Time Weather Temperature Company Humidity Wind
## 1 "?"  "Sunny" "?"         "Yes"   "?"      "?"
```

```
##      [,1] [,2]    [,3] [,4]  [,5] [,6]
## [1,] "?"  "?"     "?"  "?"   "?"  "?" 
## [2,] "?"  "Sunny" "?"  "?"   "?"  "?" 
## [3,] "?"  "?"     "?"  "?"   "?"  "?" 
## [4,] "?"  "?"     "?"  "Yes" "?"  "?" 
## [5,] "?"  "?"     "?"  "?"   "?"  "?" 
## [6,] "?"  "?"     "?"  "?"   "?"  "?"
```

---

### Practice

- Select a categorical variable for the target (ex: sex, has_ad) and *at least three* other categorical variables for the attributes.
- Perform the Candidate-Elimination Algorithm on your data. 
- Were you able to find any consistent attributes in your final hypotheses? If not, why do you think you didn't find any? If yes, which attributes?

Extra:
- Implement the Candidate-Elimination Algorithm with the EnjoySport data from lecture this morning.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="cols_macro.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "pygments",
"highlightLines": true,
"highlightLanguage": "r"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
